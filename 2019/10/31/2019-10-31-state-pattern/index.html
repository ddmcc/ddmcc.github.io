<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>设计模式之状态模式 - ddmcc</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="ddmcc"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="ddmcc"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="状态模式 　　我们用饮料贩卖机工作的例子来讲解状态模式的实现。把贩卖机的工作流程分解，可以分为一般为 待售 -&amp;gt; 选择饮料 -&amp;gt; 插入硬币 -&amp;gt; 售出 -&amp;gt; 退出饮料 -&amp;gt; 回到待售状态。"><meta property="og:type" content="article"><meta property="og:title" content="设计模式之状态模式"><meta property="og:url" content="http://example.com/2019/10/31/2019-10-31-state-pattern/"><meta property="og:site_name" content="ddmcc"><meta property="og:description" content="状态模式 　　我们用饮料贩卖机工作的例子来讲解状态模式的实现。把贩卖机的工作流程分解，可以分为一般为 待售 -&amp;gt; 选择饮料 -&amp;gt; 插入硬币 -&amp;gt; 售出 -&amp;gt; 退出饮料 -&amp;gt; 回到待售状态。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://ddmcc-1255635056.file.myqcloud.com/812502f7-2ee4-4b24-acdf-8614e8a59440.png"><meta property="og:image" content="https://ddmcc-1255635056.file.myqcloud.com/c054b9e7-4727-448f-81fa-f2be97ae19c7.png"><meta property="article:published_time" content="2019-10-31T14:00:59.000Z"><meta property="article:modified_time" content="2023-04-15T14:34:48.221Z"><meta property="article:author" content="jiangrz"><meta property="article:tag" content="设计模式 状态模式"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://ddmcc-1255635056.file.myqcloud.com/812502f7-2ee4-4b24-acdf-8614e8a59440.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2019/10/31/2019-10-31-state-pattern/"},"headline":"设计模式之状态模式","image":["https://ddmcc-1255635056.file.myqcloud.com/812502f7-2ee4-4b24-acdf-8614e8a59440.png","https://ddmcc-1255635056.file.myqcloud.com/c054b9e7-4727-448f-81fa-f2be97ae19c7.png"],"datePublished":"2019-10-31T14:00:59.000Z","dateModified":"2023-04-15T14:34:48.221Z","author":{"@type":"Person","name":"jiangrz"},"publisher":{"@type":"Organization","name":"ddmcc","logo":{"@type":"ImageObject","url":{"text":"jiangrz"}}},"description":"状态模式 　　我们用饮料贩卖机工作的例子来讲解状态模式的实现。把贩卖机的工作流程分解，可以分为一般为 待售 -&gt; 选择饮料 -&gt; 插入硬币 -&gt; 售出 -&gt; 退出饮料 -&gt; 回到待售状态。"}</script><link rel="canonical" href="http://example.com/2019/10/31/2019-10-31-state-pattern/"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">jiangrz</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/ddmcc/ddmcc.github.io">GitHub</a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ddmcc/ddmcc.github.io"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-10-31T14:00:59.000Z" title="2019/10/31 22:00:59">2019-10-31</time>发表</span><span class="level-item"><time dateTime="2023-04-15T14:34:48.221Z" title="2023/4/15 22:34:48">2023-04-15</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></span></div></div><h1 class="title is-3 is-size-4-mobile">设计模式之状态模式</h1><div class="content"><h2 id="状态模式"><a href="#状态模式" class="headerlink" title="状态模式"></a>状态模式</h2><p> 　　我们用饮料贩卖机工作的例子来讲解状态模式的实现。把贩卖机的工作流程分解，可以分为一般为 <strong>待售 -&gt; 选择饮料 -&gt; 插入硬币 -&gt; 售出 -&gt; 退出饮料 -&gt; 回到待售状态。</strong></p>
<span id="more"></span>
<p>每一次售出饮料都是这个步骤，贩卖机的状态始终在这些状态中游走。同时为了我们的贩卖机更加的安全，需要在每次请求的时候判断当前的状态是否允许这么做。比如贩卖机要退出饮料，<br>要先确认当前是否为售出的状态？以及饮料的库存</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ddmcc</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DrinkMachine</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 售罄状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SOLD_OUT</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 没有硬币 也就是待售状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">NO_COIN</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 选择饮料</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">CHOOSE_DRINK</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 投入硬币</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">HAS_COIN</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 售出状态 等待退出饮料</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SOLD</span> <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当前剩余饮料数量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当前状态 默认为售罄</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">currentState</span> <span class="operator">=</span> SOLD_OUT;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DrinkMachine</span><span class="params">(<span class="type">int</span> count)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.count = count;</span><br><span class="line">        <span class="keyword">if</span> (count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            currentState = NO_COIN;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 选择饮料</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">chooseDrink</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (currentState == NO_COIN) &#123;</span><br><span class="line">            currentState = CHOOSE_DRINK;</span><br><span class="line">            System.out.println(<span class="string">&quot;饮料选择成功，请投币！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == SOLD_OUT) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;饮料已售罄！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == CHOOSE_DRINK) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请勿重复选择！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == HAS_COIN) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请勿重复选择！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == SOLD) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请勿重复选择！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 投币操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertCoin</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (currentState == CHOOSE_DRINK) &#123;</span><br><span class="line">            currentState = HAS_COIN;</span><br><span class="line">            System.out.println(<span class="string">&quot;投币成功，请稍等！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == SOLD_OUT) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;投币失败，饮料已售罄&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == NO_COIN) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请先选择饮料！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == HAS_COIN) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请勿重复投币！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == SOLD) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请勿重复投币！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 退币操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">ejectCoin</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (currentState == HAS_COIN) &#123;</span><br><span class="line">            currentState = NO_COIN;</span><br><span class="line">            System.out.println(<span class="string">&quot;退币成功！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == SOLD_OUT) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;退币失败！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == CHOOSE_DRINK) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;退币失败！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == NO_COIN) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请先投币！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == SOLD) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;退币失败！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 确认购买饮料操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">returnDrink</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (currentState == HAS_COIN) &#123;</span><br><span class="line">            currentState = SOLD;</span><br><span class="line">            System.out.println(<span class="string">&quot;请收好饮料！&quot;</span>);</span><br><span class="line">            dispense();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == SOLD_OUT) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;饮料已售罄！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == CHOOSE_DRINK) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请勿重复选择！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == NO_COIN) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请先投币！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == SOLD) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;饮料已退出！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 退出饮料</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dispense</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (currentState == SOLD) &#123;</span><br><span class="line">            count -= <span class="number">1</span>;</span><br><span class="line">            System.out.println(<span class="string">&quot;欢迎下次光临！&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (count &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">                currentState = NO_COIN;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                currentState = SOLD_OUT;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == NO_COIN) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请先选择饮料！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == CHOOSE_DRINK) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请先投币！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == HAS_COIN) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请点击退出饮料！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentState == SOLD_OUT) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;饮料已售罄！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p> 　　上面是根据贩卖机的工作流程编写的代码。首先贩卖机类内部有几种状态常量，还有记录当前状态和当前的数量的变量。然后是几个操作方法分别为：<code>选择饮料</code>，<code>投币</code>，<code>退币</code>，<code>机器退出饮料</code>，<code>发放饮料</code>。</p>
<ul>
<li><p><strong>选择饮料</strong><br>只有在<code>待售</code>的状态才能选择饮料，否则提示错误信息。选择饮料后则将状态转为<code>选择饮料的状态</code>等待投入硬币</p>
</li>
<li><p><strong>投币</strong><br>只有在<code>选择饮料状态</code>下才能够投币，投币后变为<code>已投币</code>状态等待用户确认购买操作</p>
</li>
<li><p><strong>退币</strong><br>在<code>已投币</code>状态下用户可以选择退币，退币后状态转为<code>未投币</code></p>
</li>
<li><p><strong>确认购买饮料</strong><br>在<code>已投币</code>状态下除了可以退币，还可以确认购买，确认购买后饮料机将状态转为<code>SOLD</code>状态并调用<code>dispense()</code>方法，执行发放饮料操作</p>
</li>
</ul>
<ul>
<li><strong>发放饮料</strong><br>将count - 1并判断剩余数量，转为售罄或未投币</li>
</ul>
<hr>
<p> 　　上面的实现代码满足了贩卖机的需求，但是并不是健壮的代码。首先违反了开-闭原则，当有新的状态加入我们就不得不重新打开代码这个类来修改，并且每个方法都会被影响。。。<br> 而且代码可读性也不佳。if-else是很影响代码可读性的，state的变化也隐藏在if语句里，并不明显。很可能对后面维护这些代码的人带来麻烦。重要的是没有将变化的部分 <strong>封装</strong> 起来！</p>
<h2 id="引入状态模式"><a href="#引入状态模式" class="headerlink" title="引入状态模式"></a>引入状态模式</h2><p> 　　现在我们尝试将“变化的部分”封装起来，变化的部分就是 <strong>状态</strong>。利用面向对象的思想，将每个状态封装为一个具体的类，将状态各自的行为放到自己的类中，那么每个状态只要实现自己的规则即可。<br> 然后将贩卖机委托给当前的状态对象，当调用某个方法时，再调用状态对象的方法。</p>
<ul>
<li><p>首先，定义一个State接口。接口里有贩卖机每个动作的方法</p>
</li>
<li><p>然后每个状态创建一个具体的状态类，状态类实现State接口，并实现在这个状态下贩卖机的行为</p>
</li>
<li><p>最后将贩卖机的动作委托到状态类</p>
</li>
</ul>
<h3 id="封装的状态类图"><a href="#封装的状态类图" class="headerlink" title="封装的状态类图"></a>封装的状态类图</h3><p><img src="https://ddmcc-1255635056.file.myqcloud.com/812502f7-2ee4-4b24-acdf-8614e8a59440.png" alt="markdown"></p>
<hr>
<p> 　　我们已经知道每个状态下什么行为应该做什么，上面代码已经实现过了，现在只是把它们分散在各自类中。</p>
<p><strong>定义状态接口</strong></p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 状态接口</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ddmcc</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">State</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 选择饮料</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">chooseDrink</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 投币操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insertCoin</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 退币操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">ejectCoin</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 确认购买饮料操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">returnDrink</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 退出饮料</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">dispense</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>实现待售状态类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 待售状态</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ddmcc</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NoCoinState</span> <span class="keyword">implements</span> <span class="title class_">State</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 贩卖机实例变量，通过它控制贩卖机的状态，饮料数量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> DrinkMachine drinkMachine;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">NoCoinState</span><span class="params">(DrinkMachine drinkMachine)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.drinkMachine = drinkMachine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">chooseDrink</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 待售状态下 进行选择饮料操作</span></span><br><span class="line">        drinkMachine.setCurrentState(drinkMachine.getChooseDrinkState());</span><br><span class="line">        System.out.println(<span class="string">&quot;饮料选择成功！请投币&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertCoin</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;请先选择饮料！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">ejectCoin</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;请先投币！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">returnDrink</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;请先选择饮料！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dispense</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;请先选择饮料！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><strong>新的贩卖机</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ddmcc</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DrinkMachine</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 状态常量都由状态对象代替了</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> State noCoinState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> State hasCoinState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> State soldOutState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> State soldState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> State chooseDrinkState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 记录当前状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> State currentState;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DrinkMachine</span><span class="params">(<span class="type">int</span> count)</span> &#123;</span><br><span class="line">        noCoinState = <span class="keyword">new</span> <span class="title class_">NoCoinState</span>(<span class="built_in">this</span>);</span><br><span class="line">        hasCoinState = <span class="keyword">new</span> <span class="title class_">HasCoinState</span>(<span class="built_in">this</span>);</span><br><span class="line">        soldOutState = <span class="keyword">new</span> <span class="title class_">SoldOutState</span>(<span class="built_in">this</span>);</span><br><span class="line">        soldState = <span class="keyword">new</span> <span class="title class_">SoldState</span>(<span class="built_in">this</span>);</span><br><span class="line">        chooseDrinkState = <span class="keyword">new</span> <span class="title class_">ChooseDrinkState</span>(<span class="built_in">this</span>);</span><br><span class="line">        <span class="keyword">if</span> (count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            currentState = noCoinState;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            currentState = soldOutState;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 选择饮料</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">chooseDrink</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 动作都委托给当前的状态对象了</span></span><br><span class="line">        currentState.chooseDrink();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 投币操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertCoin</span><span class="params">()</span> &#123;</span><br><span class="line">        currentState.insertCoin();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 退币操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">ejectCoin</span><span class="params">()</span> &#123;</span><br><span class="line">        currentState.ejectCoin();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 退出饮料操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">returnDrink</span><span class="params">()</span> &#123;</span><br><span class="line">        currentState.returnDrink();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 退出饮料</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dispense</span><span class="params">()</span> &#123;</span><br><span class="line">        currentState.dispense();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<hr>
<p> 　　上面只实现了一个状态的伪代码，其它状态类也差不多，也就是把一开始的代码“局部化”。上面版本中针对第一版本进行了以下优化：</p>
<ul>
<li><p>将每个状态的行为封装进各自的类中</p>
</li>
<li><p>删除if语句，方便日后维护</p>
</li>
<li><p>让每一个状态“对修改关闭”，让贩卖机对“扩展开放”，因为可以加入新的状态，而我们也把所有的状态都放在贩卖机中了。对修改关闭怎么理解呢？其实之前已经说过了，修改关闭不是说<br>不让修改，而是修改不应该对其它带来影响。而为什么要把所有状态放到贩卖机呢？首先贩卖机总是在这些状态中游走，其次可以降低状态类间的依赖。（如果把状态变化放到贩卖机中，则可以让状态类<br>之间完全没有依赖，而我们选择了在状态类中转换状态，贩卖机提供getter方法，把状态之间的的依赖降到最低）</p>
</li>
</ul>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p> 　　<strong>允许对象在内部状态改变时改变它的行为，对象看起来好像改变了它的类。</strong></p>
<ul>
<li>允许对象在内部状态改变时改变它的行为</li>
</ul>
<p>因为我们将状态封装成不同的类，并将动作委托到当前状态中，当状态改变时，行为也就变了</p>
<ul>
<li>对象看起来好像改变了它的类</li>
</ul>
<p>对于客户端而言，并不知道内部如何实现，看起来就好像一个新的实例。其实是通过引用不同状态来造成的假象</p>
<h2 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h2><p><img src="https://ddmcc-1255635056.file.myqcloud.com/c054b9e7-4727-448f-81fa-f2be97ae19c7.png" alt="markdown"></p>
<h2 id="状态模式的优缺点"><a href="#状态模式的优缺点" class="headerlink" title="状态模式的优缺点"></a>状态模式的优缺点</h2><ul>
<li><p>优点</p>
<ul>
<li>将不同行为“局部化”，符合开-闭原则</li>
<li>通过组合，委托的方式动态的改变行为</li>
</ul>
</li>
<li><p>缺点</p>
<ul>
<li>导致设计中的类数目大大增加</li>
</ul>
</li>
</ul>
<h2 id="状态模式与策略模式"><a href="#状态模式与策略模式" class="headerlink" title="状态模式与策略模式"></a>状态模式与策略模式</h2><ul>
<li>状态模式<ul>
<li>我们将一群行为封装在状态对象中，Context可以随时委托到那些对象中的一个。随着时间流逝，当前状态在状态集合中游走，因此Context的行为也会跟着改变。但是对于Context的客户来说<br>这是浑然不觉的。</li>
<li>状态模式可以看成在Context中不用放很多判断条件，将不同的行为封装到不同的状态中，通过改变当前状态来改变行为</li>
</ul>
</li>
</ul>
<p><strong>在固定的状态集合中游走</strong>，<strong>用户浑然不觉</strong></p>
<ul>
<li>策略模式<ul>
<li>客户通常主动的指定要组合的策略对象是哪一个，摆脱继承的束缚，通过组合的方式动态的改变策略。</li>
</ul>
</li>
</ul>
<p><strong>客户指定组合策略</strong>，<strong>比继承的更有弹性替代方案</strong></p>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/">设计模式 状态模式</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/11/18/2019-11-18-isolation-level-of-transaction/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">事务的隔离级别</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/10/08/2019-10-08-iterator-pattern/"><span class="level-item">设计模式之迭代器模式</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "4a834a8f1920653fd14ce7f979179f60",
            repo: "ddmcc.github.io",
            owner: "ddmcc",
            clientID: "dae41ffb8c8e11287ad0",
            clientSecret: "2e2acba40e8060cbac419bae13b068ab92a539ab",
            admin: ["ddmcc"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "zh-CN",
        })
        gitalk.render('comment-container')</script></div></div></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen  order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#状态模式"><span class="level-left"><span class="level-item">1</span><span class="level-item">状态模式</span></span></a></li><li><a class="level is-mobile" href="#引入状态模式"><span class="level-left"><span class="level-item">2</span><span class="level-item">引入状态模式</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#封装的状态类图"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">封装的状态类图</span></span></a></li></ul></li><li><a class="level is-mobile" href="#定义"><span class="level-left"><span class="level-item">3</span><span class="level-item">定义</span></span></a></li><li><a class="level is-mobile" href="#类图"><span class="level-left"><span class="level-item">4</span><span class="level-item">类图</span></span></a></li><li><a class="level is-mobile" href="#状态模式的优缺点"><span class="level-left"><span class="level-item">5</span><span class="level-item">状态模式的优缺点</span></span></a></li><li><a class="level is-mobile" href="#状态模式与策略模式"><span class="level-left"><span class="level-item">6</span><span class="level-item">状态模式与策略模式</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-07-06T07:34:00.000Z">2023-07-06</time></p><p class="title"><a href="/2023/07/06/2023-07-06-feign-integrates-ribbon/">feign基于ribbon实现负载均衡</a></p><p class="categories"><a href="/categories/Spring-Cloud/">Spring Cloud</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-29T07:34:00.000Z">2023-05-29</time></p><p class="title"><a href="/2023/05/29/2023-05-29-ribbon-components-and-integration-of-gateway/">openFeign整合ribbon实现负载均衡</a></p><p class="categories"><a href="/categories/Spring-Cloud/">Spring Cloud</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-05-29T07:34:00.000Z">2023-05-29</time></p><p class="title"><a href="/2023/05/29/2023-05-29-websocket-clusters/">websocket服务集群搭建与消息收发实现</a></p><p class="categories"><a href="/categories/websocket/">websocket</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-13T07:34:00.000Z">2023-04-13</time></p><p class="title"><a href="/2023/04/13/2023-04-13-how-feign-works/">OpenFeign的实现原理</a></p><p class="categories"><a href="/categories/Spring-Cloud/">Spring Cloud</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-04-01T07:34:00.000Z">2023-04-01</time></p><p class="title"><a href="/2023/04/01/2023-04-01-composite-pattern/">设计模式之组合模式</a></p><p class="categories"><a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">jiangrz</a><p class="is-size-7"><span>&copy; 2024 jiangrz</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent " target="_blank" rel="noopener" title="备案号：闽ICP备2023008580号-1" href="https://beian.miit.gov.cn">备案号：闽ICP备2023008580号-1</a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>